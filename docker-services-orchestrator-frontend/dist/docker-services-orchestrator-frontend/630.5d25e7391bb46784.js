"use strict";(self.webpackChunkdocker_services_orchestrator_frontend=self.webpackChunkdocker_services_orchestrator_frontend||[]).push([[630],{4630:(q,T,i)=>{i.r(T),i.d(T,{ImagesModule:()=>_});var A=i(1083),m=i(3075),c=i(5698),f=i(3900),u=i(8505),h=i(262),v=i(2843),N=i(9841),R=i(5029),t=i(5e3),x=i(8966),w=i(5830),M=i(1271),p=i(1125),C=i(4106),Z=i(7531),b=i(9808),y=i(7423),O=i(773),l=i(4999),S=i(5245);function U(e,r){if(1&e&&(t.TgZ(0,"button",18),t._uU(1," Carregar "),t.qZA()),2&e){const o=t.oxw();t.Q6J("disabled",o.imageForm.invalid)}}function J(e,r){1&e&&t._UZ(0,"mat-spinner",19),2&e&&t.Q6J("diameter",35)}function Y(e,r){1&e&&(t.TgZ(0,"th",20),t._uU(1,"ID."),t.qZA())}function P(e,r){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.Oqu(o.id)}}function D(e,r){1&e&&(t.TgZ(0,"th",20),t._uU(1,"Nome."),t.qZA())}function F(e,r){if(1&e&&(t.TgZ(0,"td",21),t._uU(1),t.qZA()),2&e){const o=r.$implicit;t.xp6(1),t.Oqu(o.name)}}function k(e,r){1&e&&(t.TgZ(0,"th",20),t._uU(1,"A\xe7\xe3o"),t.qZA())}function Q(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"td",21)(1,"div")(2,"button",22),t.NdJ("click",function(){const s=t.CHM(o).$implicit;return t.oxw().deleteImage(s.id)}),t.TgZ(3,"mat-icon"),t._uU(4,"delete"),t.qZA()()()()}}function E(e,r){1&e&&t._UZ(0,"tr",23)}function z(e,r){1&e&&t._UZ(0,"tr",24)}const j=A.Bz.forChild([{path:"",component:(()=>{class e{constructor(o,a,n,s){this.dialog=o,this.apiService=a,this.snackbar=n,this.cdr=s,this.imageForm=new m.cw({name:new m.NI("",[m.kI.required]),tag:new m.NI("")}),this.dataSource=[],this.displayedColumns=["id","name","action"],this.uploadingImage=!1}ngOnInit(){this.apiService.get("images").pipe((0,c.q)(1)).subscribe(o=>this.dataSource=o.filter(a=>{var n,s;return!(null===(n=a.RepoTags)||void 0===n?void 0:n[0].includes("grafana"))&&!(null===(s=a.RepoTags)||void 0===s?void 0:s[0].includes("prometheus"))}).map(a=>{var n;return{id:a.Id,name:null===(n=a.RepoTags)||void 0===n?void 0:n[0]}}))}ngOnDestroy(){}createImage(){this.uploadingImage=!0,this.apiService.post("images",this.imageForm.getRawValue()).pipe((0,c.q)(1),(0,f.w)(()=>this.apiService.get("images").pipe((0,c.q)(1),(0,u.b)(o=>this.dataSource=o.filter(a=>{var n,s;return!(null===(n=a.RepoTags)||void 0===n?void 0:n[0].includes("grafana"))&&!(null===(s=a.RepoTags)||void 0===s?void 0:s[0].includes("prometheus"))}).map(a=>{var n;return{id:a.Id,name:null===(n=a.RepoTags)||void 0===n?void 0:n[0]}})))),(0,u.b)(()=>this.uploadingImage=!1),(0,h.K)(o=>(this.uploadingImage=!1,this.snackbar.open("Falha ao carregar imagem","Error",{duration:3e3}),this.cdr.markForCheck(),(0,v._)(()=>{})))).subscribe(()=>{this.cdr.markForCheck(),this.snackbar.open("Opera\xe7\xe3o concluida com sucesso","Success",{duration:3e3})})}deleteImage(o){this.dialog.open(R.V,{height:"170px",width:"300px"}).afterClosed().subscribe(n=>{n&&this.apiService.delete(`images/${o}`).pipe((0,c.q)(1),(0,f.w)(()=>this.apiService.get("images").pipe((0,c.q)(1),(0,u.b)(s=>this.dataSource=s.filter(g=>{var d,I;return!(null===(d=g.RepoTags)||void 0===d?void 0:d[0].includes("grafana"))&&!(null===(I=g.RepoTags)||void 0===I?void 0:I[0].includes("prometheus"))}).map(g=>{var d;return{id:g.Id,name:null===(d=g.RepoTags)||void 0===d?void 0:d[0]}})))),(0,h.K)(s=>(409===s.status&&this.snackbar.open("A imagem esta sendo utilizada por um container ativo","Error",{duration:3e3}),(0,v._)(()=>{})))).subscribe(()=>{this.cdr.markForCheck(),this.snackbar.open("Opera\xe7\xe3o concluida com sucesso","Success",{duration:3e3})})})}removeAllImages(){(0,N.a)([...this.dataSource.map(o=>this.apiService.delete(`images/${o.id}`))]).pipe((0,c.q)(1),(0,h.K)(o=>(409===o.status&&this.snackbar.open("Algumas imagens est\xe3o sendo utilizadas por um container ativo","Error",{duration:3e3}),(0,v._)(()=>{}))),(0,f.w)(()=>this.apiService.get("images").pipe((0,c.q)(1),(0,u.b)(o=>this.dataSource=o.filter(a=>{var n,s;return!(null===(n=a.RepoTags)||void 0===n?void 0:n[0].includes("grafana"))&&!(null===(s=a.RepoTags)||void 0===s?void 0:s[0].includes("prometheus"))}).map(a=>{var n;return{id:a.Id,name:null===(n=a.RepoTags)||void 0===n?void 0:n[0]}}))))).subscribe(()=>{this.cdr.markForCheck(),this.snackbar.open("Opera\xe7\xe3o concluida com sucesso","Success",{duration:3e3})})}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(x.uw),t.Y36(w.s),t.Y36(M.ux),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-images"]],decls:36,vars:6,consts:[[1,"title"],[1,"create-image"],[3,"formGroup","ngSubmit"],["matInput","","formControlName","name"],["matInput","","formControlName","tag"],["mat-raised-button","","color","primary","type","submit",3,"disabled",4,"ngIf"],[3,"diameter",4,"ngIf"],[1,"list-images"],[1,"remove-all"],["mat-raised-button","","color","primary",3,"click"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","action"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"diameter"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,a){1&o&&(t.TgZ(0,"div",0)(1,"span"),t._uU(2,"Imagens"),t.qZA()(),t.TgZ(3,"div",1)(4,"mat-accordion")(5,"mat-expansion-panel")(6,"mat-expansion-panel-header")(7,"mat-panel-title"),t._uU(8," Carregar nova imagem "),t.qZA()(),t.TgZ(9,"form",2),t.NdJ("ngSubmit",function(){return a.createImage()}),t.TgZ(10,"mat-form-field")(11,"mat-label"),t._uU(12,"Nome da imagem"),t.qZA(),t._UZ(13,"input",3),t.qZA(),t.TgZ(14,"mat-form-field")(15,"mat-label"),t._uU(16,"Tag"),t.qZA(),t._UZ(17,"input",4),t.qZA(),t.YNc(18,U,2,1,"button",5),t.YNc(19,J,1,1,"mat-spinner",6),t.qZA()()()(),t.TgZ(20,"div",7)(21,"div",8)(22,"button",9),t.NdJ("click",function(){return a.removeAllImages()}),t._uU(23," Excluir todas as imagens "),t.qZA()(),t.TgZ(24,"table",10),t.ynx(25,11),t.YNc(26,Y,2,0,"th",12),t.YNc(27,P,2,1,"td",13),t.BQk(),t.ynx(28,14),t.YNc(29,D,2,0,"th",12),t.YNc(30,F,2,1,"td",13),t.BQk(),t.ynx(31,15),t.YNc(32,k,2,0,"th",12),t.YNc(33,Q,5,0,"td",13),t.BQk(),t.YNc(34,E,1,0,"tr",16),t.YNc(35,z,1,0,"tr",17),t.qZA()()),2&o&&(t.xp6(9),t.Q6J("formGroup",a.imageForm),t.xp6(9),t.Q6J("ngIf",!a.uploadingImage),t.xp6(1),t.Q6J("ngIf",a.uploadingImage),t.xp6(5),t.Q6J("dataSource",a.dataSource),t.xp6(10),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns))},directives:[p.pp,p.ib,p.yz,p.yK,m._Y,m.JL,m.sg,C.KE,C.hX,Z.Nt,m.Fj,m.JJ,m.u,b.O5,y.lW,O.Ou,l.BZ,l.w1,l.fO,l.ge,l.Dz,l.ev,S.Hw,l.as,l.XQ,l.nj,l.Gk],styles:[".create-image[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;margin-top:20px}.create-image[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:20px}.list-images[_ngcontent-%COMP%]{width:100%;margin-top:40px;display:column;align-items:center;justify-content:center}.list-images[_ngcontent-%COMP%]   .remove-all[_ngcontent-%COMP%]{width:98%;display:flex;align-items:flex-end;justify-content:flex-end}table[_ngcontent-%COMP%]{width:98%;margin-top:10px;margin-left:20px}mat-accordion[_ngcontent-%COMP%]{width:90%}mat-expansion-panel[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]{width:40%;margin-left:20px}form[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;align-items:baseline}.mat-column-id[_ngcontent-%COMP%]{width:70%!important}.title[_ngcontent-%COMP%]{margin-top:20px;margin-left:30px;font-size:30px;font-weight:500}"]}),e})()}]);let _=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[b.ez,j,p.To,Z.c,C.lN,m.UX,y.ot,l.p0,S.Ps,x.Is,O.Cq]]}),e})()}}]);